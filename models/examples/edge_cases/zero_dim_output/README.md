# zero_dim_output - é›¶ç»´è¾“å‡ºæ¨¡å‹

---

## ğŸ“Œ ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬**ï¼š1.0
- **çŠ¶æ€**ï¼šstable
- **æœ€åæ›´æ–°**ï¼š2025-11-12
- **æœ€åå®¡æ ¸**ï¼š2025-11-12
- **æ‰€æœ‰è€…**ï¼šAIæ¨¡å‹ç®¡ç†ç»„
- **é€‚ç”¨èŒƒå›´**ï¼šWES é¡¹ç›®ä¸­ zero_dim_output æ¨¡å‹ç›¸å…³åŠŸèƒ½

---

## ğŸ“ ç»„ä»¶å®šä½

é›¶ç»´è¾“å‡ºæ¨¡å‹ï¼Œç”¨äºæµ‹è¯•æ ‡é‡è¾“å‡ºå¤„ç†ã€‚è¯¥æ¨¡å‹æ¥å— 2x8 è¾“å…¥ï¼Œå½“è¾“å…¥å…¨ä¸º 0 æ—¶ï¼Œä¼šäº§ç”Ÿ 2x0x8 çš„è¾“å‡ºï¼ˆå…¶ä¸­ä¸€ä¸ªç»´åº¦ä¸º 0ï¼‰ï¼Œä¸»è¦ç”¨äºéªŒè¯ WES å¹³å°å¯¹é›¶ç»´å¼ é‡å’Œè¾¹ç•Œæ¡ä»¶çš„å¤„ç†èƒ½åŠ›ã€‚

## æ–‡ä»¶è¯´æ˜

- **example_0_dim_output.onnx**: ONNX æ ¼å¼çš„æ¨¡å‹æ–‡ä»¶
- **generate_0_dimension_output.py**: ç”¨äºç”Ÿæˆæ¨¡å‹çš„ Python è„šæœ¬
  - â­ **è¯¦ç»†æ³¨é‡Š**ï¼šè„šæœ¬åŒ…å«è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼Œè§£é‡Šé›¶ç»´å¼ é‡ã€è¾¹ç•Œæ¡ä»¶ã€åŠ¨æ€ç»´åº¦ç­‰å…³é”®æ¦‚å¿µ
  - ğŸ“š **å­¦ä¹ ä»·å€¼**ï¼šé€‚åˆå­¦ä¹ è¾¹ç•Œæ¡ä»¶å¤„ç†å’Œ WES å¹³å°ç‰¹æ®Šåœºæ™¯æ”¯æŒ

## æ¨¡å‹è§„æ ¼

### è¾“å…¥
- **åç§°**: `x`
- **å½¢çŠ¶**: `[2, 8]`
- **ç±»å‹**: `float32`
- **æè¿°**: 2x8 çŸ©é˜µ

### è¾“å‡º
- **åç§°**: `y`
- **å½¢çŠ¶**: `[2, N, 8]` (å…¶ä¸­ N = sum(x[:, 0])ï¼Œå½“è¾“å…¥å…¨ä¸º 0 æ—¶ N=0)
- **ç±»å‹**: `float32`
- **æè¿°**: å½“è¾“å…¥å…¨ä¸º 0 æ—¶ï¼Œè¾“å‡ºå½¢çŠ¶ä¸º `[2, 0, 8]`ï¼ˆé›¶ç»´ï¼‰

### è®¡ç®—è¿‡ç¨‹
1. å¯¹è¾“å…¥æŒ‰åˆ—æ±‚å’Œ
2. å–ç¬¬ä¸€åˆ—çš„å’Œå¹¶è½¬æ¢ä¸ºæ•´æ•°
3. æ‰©å±•ä¸º `[2, N, 8]` å½¢çŠ¶
4. å½“è¾“å…¥å…¨ä¸º 0 æ—¶ï¼ŒN=0ï¼Œäº§ç”Ÿé›¶ç»´è¾“å‡º

## ä½¿ç”¨æ–¹æ³•

### é‡æ–°ç”Ÿæˆæ¨¡å‹

```bash
cd zero_dim_output
python generate_0_dimension_output.py
```

### ä¾èµ–è¦æ±‚

```bash
pip install torch onnx
```

### Python æµ‹è¯•ç¤ºä¾‹

```python
import onnxruntime as ort
import numpy as np

# åŠ è½½æ¨¡å‹
session = ort.InferenceSession("example_0_dim_output.onnx")

# å‡†å¤‡è¾“å…¥æ•°æ®ï¼ˆå…¨é›¶ï¼Œä¼šäº§ç”Ÿé›¶ç»´è¾“å‡ºï¼‰
inputs = np.zeros((2, 8), dtype=np.float32)

# è¿è¡Œæ¨ç†
outputs = session.run(["y"], {"x": inputs})

print(f"Output shape: {outputs[0].shape}")  # åº”è¯¥æ˜¯ (2, 0, 8)
```

### WES éƒ¨ç½²

```bash
wes ai deploy example_0_dim_output.onnx \
    --name "Zero Dimension Output" \
    --description "Test model for zero-dimensional output"
```
## ğŸ§ª æµ‹è¯•è§„èŒƒï¼ˆWESï¼‰

### 1. å‚è€ƒç¯å¢ƒ

- **WES ç‰ˆæœ¬**ï¼š`weisyn-testing`ï¼ˆ`make build-test`ï¼‰
- **è¿è¡Œç¯å¢ƒ**ï¼š`env = testing`ï¼Œå•èŠ‚ç‚¹æ¨¡å¼

### 2. åŸºå‡†æµ‹è¯•ç”¨ä¾‹ï¼ˆCanonical Test Caseï¼‰

#### è¾“å…¥å®šä¹‰

| åç§° | å½¢çŠ¶    | æ•°æ®ç±»å‹  | å­—æ®µ  | ç¤ºä¾‹å€¼è¯´æ˜                   |
|------|---------|-----------|-------|------------------------------|
| `x`  | `[2, 8]` | `float32` | `data` | 16 ä¸ª 0.0ï¼ˆå…¨é›¶è¾“å…¥ï¼‰ |

å¯¹åº” JSON ç‰‡æ®µï¼š

```json
[
  {
    "name": "x",
    "data": [
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    ],
    "shape": [2, 8],
    "data_type": "float32"
  }
]
```

#### æœŸæœ›è¾“å‡º

- ç†è®ºè¾“å‡º 0ï¼ˆ`y`ï¼‰ï¼š
  - å½¢çŠ¶ï¼š`[2, 0, 8]`
  - ç±»å‹ï¼š`float32`

å½“å‰ ONNX Runtime åœ¨ Expand + é›¶ç»´åœºæ™¯ä¸‹å¯èƒ½æŠ›å‡º `OrtValue shape verification failed` ä¸”åŒ…å« `{2,0,8}`ï¼Œæµ‹è¯•è„šæœ¬å°†æ­¤è§†ä¸º **Edge-OK**ï¼š
æ¨¡å‹éƒ¨ç½²ä¸èµ„æºç´¢å¼•éªŒè¯é€šè¿‡ï¼Œé›¶ç»´è¡Œä¸ºè¢«è§†ä¸º runtime çš„å·²çŸ¥é™åˆ¶ã€‚

### 3. å…¸å‹å¤ç°æ­¥éª¤

```bash
make build-test
bash scripts/testing/models/onnx_models_test.sh example_0_dim_output
```

### 4. å·²çŸ¥é™åˆ¶ & å›å½’è¦æ±‚

- **ç±»åˆ«**ï¼š`Edge-Case`
- **å·²çŸ¥é™åˆ¶**ï¼š
  - Expand + é›¶ç»´è¾“å‡ºåœ¨å½“å‰ ONNX Runtime ç‰ˆæœ¬ä¸­å¯èƒ½æ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œåªèƒ½é€šè¿‡é”™è¯¯ä¿¡æ¯éªŒè¯é¢„æœŸè¡Œä¸ºã€‚
- **å›å½’è¦æ±‚**ï¼š
  - å‡çº§ ONNX Runtime æˆ–è°ƒæ•´ ONNX å¼•æ“å½¢çŠ¶å¤„ç†é€»è¾‘æ—¶ï¼Œåº”é‡è·‘æœ¬ç”¨ä¾‹ï¼Œæ£€æŸ¥é”™è¯¯ä¿¡æ¯æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼›
  - è‹¥æœªæ¥ runtime æ”¯æŒè¯¥åœºæ™¯ï¼Œå¯å°†æœ¬ç”¨ä¾‹ä» `edge-ok` å‡çº§ä¸º `strict-pass`ï¼Œå¹¶è¡¥å……æ•°å€¼æ–­è¨€ã€‚

## æµ‹è¯•åœºæ™¯

- âœ… é›¶ç»´å¼ é‡æ”¯æŒï¼ˆé“¾è·¯çº§éªŒè¯ï¼‰
- âœ… æ ‡é‡è¾“å‡ºå¤„ç†
- âœ… è¾¹ç•Œæ¡ä»¶å¤„ç†
- âœ… åŠ¨æ€å½¢çŠ¶æ¨æ–­ï¼ˆåŸºäºè¾“å…¥å€¼ï¼‰

## æ¨¡å‹æ¥æº

**åŸå§‹ä»“åº“**: [onnxruntime_go](https://github.com/yalue/onnxruntime_go)  
**è®¸å¯è¯**: MIT License


