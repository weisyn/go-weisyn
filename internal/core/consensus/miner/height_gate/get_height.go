// Package height_gate å®ç°é«˜åº¦é—¨é—¸ç®¡ç†å™¨çš„é«˜åº¦è·å–åŠŸèƒ½
//
// ğŸ“Š **é«˜åº¦è·å–åŠŸèƒ½æ¨¡å—**
//
// å®ç° GetLastProcessedHeight æ–¹æ³•ï¼Œæä¾›è¶…é«˜æ€§èƒ½çš„åŸå­é«˜åº¦è¯»å–ã€‚
// è¯¥æ¨¡å—ä¸“æ³¨äºæè‡´æ€§èƒ½ä¼˜åŒ–ï¼Œç¡®ä¿æŒ–çŸ¿æµç¨‹ä¸­çš„é«˜é¢‘é«˜åº¦æŸ¥è¯¢ä¸æˆä¸ºç“¶é¢ˆã€‚
package height_gate

// GetLastProcessedHeight è·å–æœ€åå¤„ç†çš„åŒºå—é«˜åº¦
//
// è¿”å›å½“å‰å·²å¤„ç†çš„æœ€å¤§åŒºå—é«˜åº¦ï¼Œç”¨äºé˜²æ­¢é‡å¤æŒ–çŸ¿ã€‚
// ä½¿ç”¨åŸå­æ“ä½œç¡®ä¿å¹¶å‘å®‰å…¨ã€‚
//
// ä¸»è¦ä½¿ç”¨åœºæ™¯ï¼š
// - æŒ–çŸ¿å¯åŠ¨å‰æ£€æŸ¥å½“å‰é«˜åº¦
// - å€™é€‰åŒºå—é«˜åº¦éªŒè¯
// - ç³»ç»ŸçŠ¶æ€ç›‘æ§
//
// @return uint64 æœ€åå¤„ç†çš„åŒºå—é«˜åº¦
func (s *HeightGateService) GetLastProcessedHeight() uint64 {
	return s.performAtomicHeightRead()
}

// performAtomicHeightRead æ‰§è¡ŒåŸå­é«˜åº¦è¯»å–æ“ä½œ
//
// ä½¿ç”¨åŸå­Loadæ“ä½œè¯»å–é«˜åº¦å€¼ï¼Œä¿è¯è¯»å–çš„ä¸€è‡´æ€§ã€‚
//
// @return uint64 å½“å‰é«˜åº¦å€¼
func (s *HeightGateService) performAtomicHeightRead() uint64 {
	// ç›´æ¥åŸå­è¯»å–ï¼Œæ— ä»»ä½•é¢å¤–å¤„ç†
	// è¿™æ˜¯æ€§èƒ½å…³é”®è·¯å¾„ï¼Œä¿æŒç»å¯¹ç®€æ´
	return s.lastHeight.Load()
}
